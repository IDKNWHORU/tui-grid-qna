<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://uicdn.toast.com/grid/latest/tui-grid.css"
    />
    <script src="https://uicdn.toast.com/grid/latest/tui-grid.js"></script>
    <style type="text/css">
      .red.tui-grid-cell {
        background-color: #f8e0e0;
      }
      .blue.tui-grid-cell {
        background-color: #cef6f5;
      }
    </style>
    <title>change cell colors</title>
  </head>
  <body>
    <span>
      <p> hello, This page reproduces <a href="https://github.com/nhn/tui.grid/issues/1820">issue #1820</a></p>
    </span>
    <div>
      <button onclick="addTwoRows()">Add 2 rows</button>
      <button onclick="addARowByCheckingTwoRows()">add a row by checking 2 rows</button>
      <button onclick="moveDown()">moving down</button>
    </div>
    <div id="grid"></div>
    <script>
      const addTwoRows = () => {
        if(instance.getData().length === 0){
          instance.appendRows([{
              name: "Y",
              artist: "Birdy",
              release: "2016.03.26",
              genre: "Pop",
              _attributes: {
                className: {
                  column: {
                    name: ['red']
                  }
                }
              }
            },
            {
              name: "N",
              artist: "Birdy",
              release: "2016.03.26",
              genre: "Pop",
              _attributes: {
                className: {
                  column: {
                    name: ['blue']
                  }
                }
              }
            }]);
        }
      }

      const moveDown = () => {
        const checkedRowKeys = instance.getCheckedRowKeys();

        if(checkedRowKeys == null || checkedRowKeys.length === 0) return;

        const reversed = [...checkedRowKeys].reverse();

        reversed.forEach((rowKey, index, array) => {
          const rowIndex = instance.getIndexOfRow(rowKey);
          const afterRow = instance.getRow(rowIndex + 1);
          if (!afterRow || array.includes(afterRow.rowKey)) return;

          instance.moveRow(rowKey, rowIndex + 1);
        });
      }

      const addARowByCheckingTwoRows = () => {
        if(instance.getData().length === 2){
          instance.checkAll();
          instance.appendRows([{
            name: "N",
            artist: "new Rows",
            release: "2016.03.26",
            genre: "Pop",
            _attributes: {
              className: {
                column: {
                  name: ['blue']
                }
              }
            }
          }]);
        }
      }

      const instance = new tui.Grid({
        el: document.getElementById("grid"),
        rowHeaders: ['checkbox'],
        columns: [
          {
            header: "Y is Red/N is Blue",
            name: "name",
          },
          {
            header: "Artist",
            name: "artist",
          },
        ],
        data: [],
      });

      instance.resetData([]); // Call API of instance's public method

      tui.Grid.applyTheme("striped"); // Call API of static method
    </script>
  </body>
</html>
